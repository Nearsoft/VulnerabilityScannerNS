#!/usr/bin/env python 
# -*- coding:utf-8 -*-
#
# @name:    Wascan - Web Application Scanner
# @repo:    https://github.com/m4ll0k/Wascan
# @author:  Momo Outaadi (M4ll0k)
# @license: See the file 'LICENSE.txt

from lib.utils.printer import info
from lib.request.crawler import SCrawler

class Crawler:
    """ cralwer """
    def run(self, kwargs, url, data):
        info("Starting crawler...")
        links = []
        links.append(url)
        for k in SCrawler(kwargs, url, data).run():
            for l in SCrawler(kwargs, k, data).run():
                if l not in links:
                    print l
                    links.append(l)
            if k not in links:
                print k
                links.append(k)
        return links
