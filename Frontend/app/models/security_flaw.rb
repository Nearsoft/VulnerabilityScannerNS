# frozen_string_literal: true

class SecurityFlaw < ApplicationRecord
  def self.type_of_flaws(current_user)
    joins("INNER JOIN analyses ON analyses.id = security_flaws.analyses_id AND analyses.user_id = #{current_user}")
  end

  def self.security_flaws_count(analysis_id)
    where(analyses_id: analysis_id).count
  end

  def self.find_by_analysis_id(analysis_id)
    where(analyses_id: analysis_id)
  end
end
